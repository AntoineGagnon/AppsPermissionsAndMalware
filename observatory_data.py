"""
Created by: 

"""
from peewee import SqliteDatabase, Model, TextField, IntegerField, BlobField, ForeignKeyField

observatory = SqliteDatabase('observatory.db')


class Apps(Model):
    id = TextField(primary_key=True)
    uappid = TextField()
    pkgname = TextField()
    appname = TextField()
    binhash = TextField()
    binhash256 = TextField()
    md5 = TextField()
    dexhash = TextField()
    reshash = TextField()
    manifesthash = TextField()
    source = IntegerField()
    versionCode = IntegerField()
    timestamp = IntegerField()
    shareduserid = TextField()
    apkpath = TextField()
    version = BlobField()
    virfound = IntegerField()

    class Meta:
        database = observatory


class Permissions(Model):
    name = TextField()

    class Meta:
        database = observatory


class App_Permissions(Model):
    perm_id = ForeignKeyField(Permissions, backref="app_perm")
    app_id = ForeignKeyField(Apps, backref="app_perm")

    class Meta:
        database = observatory


class Engines(Model):
    name = TextField()

    class Meta:
        database = observatory


class Viruses(Model):
    name = TextField()

    class Meta:
        database = observatory


class App_Viruses(Model):
    virus_id = ForeignKeyField(Viruses, backref="virus")
    engine_id = ForeignKeyField(Engines, backref="engine")
    app_id = ForeignKeyField(Apps, backref="app")
    timestamp = IntegerField()
    scan_date = TextField()

    class Meta:
        database = observatory


observatory.connect()
